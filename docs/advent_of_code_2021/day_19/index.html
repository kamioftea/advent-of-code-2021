<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This is my solution for Advent of Code - Day 19 - Beacon Scanner"><meta name="keywords" content="rust, rustlang, rust-lang, day_19"><title>advent_of_code_2021::day_19 - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../advent_of_code_2021/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module day_19</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div><div id="sidebar-vars" data-name="day_19" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">advent_of_code_2021</a>::<wbr><a class="mod" href="#">day_19</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/advent_of_code_2021/day_19.rs.html#1-542" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This is my solution for <a href="https://adventofcode.com/2021/day/19">Advent of Code - Day 19 - <em>Beacon Scanner</em></a></p>
<p>Today was horrible. I find 3D geometry really hard as I can’t visualise it very well, and that hinders me
reasoning about it. It was a very similar puzzle last year that caused me to stall, so I’m very glad I worked
through this one and got to a solution. It is not very efficient, it takes 1s-1.5s to run which is a lot given
all previous days run in ~300-400ms combined. But I don’t think I have a decent enough idea how to improve it
that I’m just happy to have solved it and will take the speed hit.</p>
<p><a href="fn.parse_scanners.html" title="parse_scanners"><code>parse_scanners</code></a> is fairly simple, it splits the input on the double line breaks between scanner inputs, and
for each then returns the list of relative beacon co-ordinates. <a href="fn.try_merge.html" title="try_merge"><code>try_merge</code></a> does all the heavy lifting, it
takes the set of beacons fixed so far, and a scanner, and tries for each possible rotation to position the
beacons so that there is an overlap of twelve beacons. If it succeeds it merges the translated beacon permissions
into the set of fixed beacons, and returns the offset of the sensor from the first. <a href="fn.merge_all.html" title="merge_all"><code>merge_all</code></a> takes the initial
list of scanner inputs, sets the first as the base scanner, fixing all those beacons. Then repeatedly scans the
remaining scanners until it finds one that merges with the current set (using <a href="fn.try_merge.html" title="try_merge"><code>try_merge</code></a>). Once found, it
removes that scanner from the list, and stores its offset for solving part two.</p>
<p>Part one is solved by just taking the length of the set of beacons returned by <a href="fn.merge_all.html" title="merge_all"><code>merge_all</code></a>. For part two
<a href="fn.largest_distance.html" title="largest_distance"><code>largest_distance</code></a> takes the set of all scanner offsets, iterates through the pair combinations, mapping each
pair to their manhatten distance, then takes the max of those.</p>
</div></details><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.largest_distance.html" title="advent_of_code_2021::day_19::largest_distance fn">largest_distance</a></div><div class="item-right docblock-short"><p>Take the set of scanner offsets returned by <a href="fn.merge_all.html" title="merge_all"><code>merge_all</code></a>, explode into all combinations of pairs with
<a href="../../itertools/trait.Itertools.html#method.tuple_combinations" title="Itertools::tuple_combinations"><code>Itertools::tuple_combinations</code></a>, map those to the manhattan distance, and take the maximum.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.merge_all.html" title="advent_of_code_2021::day_19::merge_all fn">merge_all</a></div><div class="item-right docblock-short"><p>Use the first scanner as the base set, and repeatedly hunt for scanners that can be merged until the relative
positions of all of them has been determined, Return the set of beacons that results in, and the list of scanner
offsets. Note the order of the scanner list doesn’t matter so the more efficient <a href="https://doc.rust-lang.org/1.57.0/alloc/vec/struct.Vec.html#method.swap_remove" title="Vec::swap_remove"><code>Vec::swap_remove</code></a> can be used.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.parse_scanners.html" title="advent_of_code_2021::day_19::parse_scanners fn">parse_scanners</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.rotations.html" title="advent_of_code_2021::day_19::rotations fn">rotations</a></div><div class="item-right docblock-short"><p>Expand a scanner into each of the 24 possible rotations. I started off trying to build the set of rotation
functions as a static vector of closures that could be cached using <code>lazy_static!</code> but I was wasting too much
time trying to satisfy the compiler so ended up with this mess as I inlined the 6 valid combinations for each ±x,
±y permutation.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.run.html" title="advent_of_code_2021::day_19::run fn">run</a></div><div class="item-right docblock-short"><p>The entry point for running the solutions with the ‘real’ puzzle input.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.try_merge.html" title="advent_of_code_2021::day_19::try_merge fn">try_merge</a></div><div class="item-right docblock-short"><p>Explode the scanner into its 24 rotations, then for each, pair each up with every element in the fixed beacon set,
and work out the position delta needed to make them match up. If we can find 12 or more point pairs that share the
same delta, that delta gives a translation for the current rotation that has enough overlap to be confident that
is is a match. Take the first rotation (if any) that produces a match. If a match is found, apply that delta to the
current rotation of the scanner data, and merge those points with the existing fixed set. Then return the delta
as that is also the scanner position. <a href="../../itertools/trait.Itertools.html#method.cartesian_product" title="Itertools::cartesian_product">Itertools::cartesian_product</a>, <a href="../../itertools/trait.Itertools.html#method.counts" title="Itertools::counts"><code>Itertools::counts</code></a>, and
<a href="https://doc.rust-lang.org/1.57.0/core/iter/traits/iterator/trait.Iterator.html#method.find_map" title="Iterator::find_map"><code>Iterator::find_map</code></a> respectively do the pairing of scanner points with the existing beacon set, grouping by
delta, and finding the first match (if any) both for the rotations, and delta groups.</p>
</div></div></div><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Position.html" title="advent_of_code_2021::day_19::Position type">Position</a></div><div class="item-right docblock-short"><p>Type alias for a 3D co-ordinate, used for beacon and scanner offsets.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Scanner.html" title="advent_of_code_2021::day_19::Scanner type">Scanner</a></div><div class="item-right docblock-short"><p>Type alias for the data set of one scanner. A list of the relative positions of all beacons the scanner can detect.</p>
</div></div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="advent_of_code_2021" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script>
</body></html>